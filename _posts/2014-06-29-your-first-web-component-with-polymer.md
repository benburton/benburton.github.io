---
layout: post
title:  "Your First Web Component with Polymer"
date:   2014-06-29 20:51:12
categories: polymer
---

<link rel="stylesheet" type="text/css" href="{% asset_path styles.css %}">

# Your First Web Component with Polymer

I spent most of last week at Google I/O getting an overview of the next generation of Android and web development. One
of the most exciting new annocements were updates to the [Polymer](http://www.polymer-project.org/) project.

A good (well, ok, actually terrible... but good for demonstration purposes) idea would be to re-implement a
`<blink/>` tag using web components.

## Creating our web component template with Yeoman

[Yeoman](http://yeoman.io/) is a tool that generates code to start out different kinds of projects. In this tutorial,
we'll be using it to put together the scaffolding for our first web component with Polymer.

You can install Yeoman from npm using:

    npm install -g yo

Then install the [generator](https://github.com/yeoman/generator-polymer) for Polymer web components

    npm install -g generator-polymer

Normally, I keep all my projects in the root of my `~/Workspace` directory, but Polymer components want to live in
their own sandbox because they install their bower dependencies relative to the directory above them, so I use
`~/Workspace/polymer-elements`. Choose your own Polymer web components working directory, create a new directory for
our web component, and init with Yeoman. This will ask you for some details, particularly what you'd like to name your
polymer custom web component. Since `<blink/>` is reserved, for the purposes of this tutorial we'll call ours
`<polymer-blink/>`.

    cd ~/Workspace/polymer-elements
    mkdir polymer-blink
    cd polymer-blink
    yo polymer

When Yeoman has finished you will have a directory structure that looks like this:

    tree .
    .
    ├── README.md
    ├── bower.json
    ├── demo.html
    ├── index.html
    ├── polymer-blink.css
    └── polymer-blink.html

    0 directories, 6 files

Afterwards, run `bower install` to set the project's dependencies, cd into the parent workspace, and run a simple
Python http server:

    bower install
    cd ..
    python -m SimpleHTTPServer

You should keep this running for the rest of the tutorial. By default this starts a webserver at
`http://localhost:8000`. You should be able to navigate to `http://localhost:8000/polymer-blink` to see a preview of
the autogenerated documentation for your web component:

<img class="screenshot" src="{% asset_path yeoman/index.png %}"/>

Similarly, the `demo.html` file provides us with a few of what our web component will look like when embedded on a page:

<img class="screenshot" src="{% asset_path yeoman/demo.png %}"/>

Cool! Now let's start to put some customized functionality into our web component.

## Building out the web component

Our demo page was pretty boring because we haven't yet defined any logic, styling, or templating to describe how
it should behave. The polymer component is defined mostly in the `polymer-blink.html` file. Let's take a peek into what
this looks like (comments/whitespace emitted for brevity):

    <link rel="import" href="../polymer/polymer.html">

    <polymer-element name="polymer-blink" attributes="notitle">
      <template>
        <link rel="stylesheet" href="polymer-blink.css" />
        <content></content>
      </template>

      <script>
        Polymer('polymer-blink', {
        });
      </script>
    </polymer-element>

### The web component template

Inside the `<polymer-element/>` the `<template/>` tag defines the content/markup that will be put into the shadow DOM
for the web component.

If we add something to the template, it will be added to the rendered version of our `<polymer-blink/>`
element. So let's put in some text and refresh our demo page at [http://localhost:8000/polymer-blink/demo.html]() to
see what happens:

      <template>
        <link rel="stylesheet" href="polymer-blink.css" />
        <content></content>
        This is some static text in our element
      </template>


<img class="screenshot" src="{% asset_path building/static-text.png %}"/>

You can also fill out custom HTML elements if you'd like. The `<content/>` part of the template will insert the body of
the web component into the space (this is similar to AngularJS' concept of
[transclusion](https://docs.angularjs.org/api/ng/directive/ngTransclude)). Let's say we change the content of the
`<polymer-blink/>` tag in our demo.html page to include some content:

    <body unresolved>
      <p>An `polymer-blink` looks like this:</p>
      <polymer-blink>I'm blinking!</polymer-blink>
    </body>

<img class="screenshot" src="{% asset_path building/dynamic-text.png %}"/>

The content we defined inside of the `<polymer-blink/>` tag is added to the `<content/>` tag inside the `<template/>`.

Notice that the text is red. This is because we're importing `polymer-blink.css` in our template. The contents of that
file look like this:

    :host {
      display: block;
      color: red;
    }

The `:host` element is a selector which marks the root of the template. It's sort of like you'd imagine a `body`
selector applies to the entire document, but it's scoped specifically to our web component.

In our case we'll get rid of this because we don't need any specific styling for our `<polymer-blink/>` tag. We'll also
clear out the template, aside from the `<content/>` placeholder, because we'll want to simply put the content of our
tag into the shadow DOM directly:

    <template>
      <content></content>
    </template>

### Making it Blink

You may have noticed that the `polymer-blink.html` file also includes some Javascript:

     <script>
        Polymer('polymer-blink', {
        });
      </script>

This is where you can inject any necessary Javascript into your Polymer component. In our case, we want the text to
blink, and we do this by toggling on-and-off the css `visibility` attribute between `visible` and `hidden`, at an
interval of every 250 milliseconds. We want to do it when the document has finished loading, so we can use this:

    Polymer('polymer-blink', {
      domReady: function() {
        var self = this;
        setInterval(function() {
          self.style.visibility = (self.style.visibility === 'hidden') ? 'visible' : 'hidden';
        }, 250);
      }
    });

<img class="screenshot" src="{% asset_path building/blinking.gif %}"/>

The Polymer documentation outlines all sorts of other attributes you can pass in the parameter object aside from just
`domReady`, so it's worth looking over these to see what other kinds of things you can do.

## Testing

My good friend [John Paul](https://www.twitter.com/johnkpaul) would *never* use my web component, which would break
my heart, if it wasn't fully unit tested. Polymer has
[test tools project](https://github.com/Polymer/polymer-test-tools) which includes some niceties for working with unit
testing. Modify your `bower.json` file to include this library in `devDependencies` as follows:

    {
      "name": "polymer-blink",
      "version": "0.0.0",
      "keywords": "seed, polymer, web-components",
      "main": "polymer-blink.html",
      "dependencies": {
        "polymer": "Polymer/polymer#~0.3.1"
      },
      "devDependencies": {
        "polymer-test-tools": "Polymer/polymer-test-tools#master"
      }
    }

... more to come ...

<img class="screenshot" src="{% asset_path testing/runner.png %}"/>
